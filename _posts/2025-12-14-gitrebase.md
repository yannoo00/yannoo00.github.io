---
title:  "git rebase"
layout: post
excerpt: "git rebase"

categories:
  - others 
tags:
  - [git]

toc: true
toc_sticky: true
 
date: 2025-12-14
last_modified_at: 2025-12-14
---

<br>

## git rebase

나는 그동안 git merge만 사용해봤다. 그마저도 github desktop의 GUI로 간편하게 사용해왔는데,  
어느날 새로 들어간 프로젝트에서 히스토리 관리를 위해 git rebase만 사용해야 하는 상황에 놓였고 당황했던 기억에 정리해두게 되었다.  

git rebase란 무엇일까?  

git rebase는 브랜치의 기준점(base)를 변경하는 명령어다. 커밋 히스토리를 재작성하여 '선형적인' 히스토리를 만들 수 있다.  
즉 내 현재 브랜치의 커밋들을 다른 브랜치의 마지막 커밋 위로 쌓는 작업이다.  

### 동작 방식
1. 현재 브랜치의 작업 내역(커밋)을 임시 저장한다.
2. 현재 브랜치의 베이스를 target 브랜치(main)의 최신 위치로 이동시킨다.
3. 아까 저장해 둔 커밋들을 그 위에 하나씩 다시 적용한다.

이렇게 하면 가지가 뻗어나가는 모양이 아니라, 마치 처음부터 그 위에서 작업한 것처럼 **한 줄(Linear)로 깔끔한 히스토리**가 만들어진다.


<br>

### Merge vs Rebase 비교

왜 굳이 Rebase를 쓸까? 가장 큰 차이는 **'히스토리의 모양'**이다.  

**Merge:**
- 두 브랜치를 합치는 새로운 merge commit 생성
- 모든 히스토리가 그대로 보존됨
- 히스토리가 비선형적이고 복잡해질 수 있음

**Rebase:**
- 커밋들을 다른 브랜치 위로 재배치
- 선형적이고 깔끔한 히스토리 유지
- 협업 시 주의 필요

<br>


## 내가 겪은 문제: Rebase 후 무심코 한 git pull  


rebase 후 pull을 하면 문제가 발생할 수 있다.  
rebase 과정에서, target branch에서 가져온 커밋들이 target branch에 같은 내용 그대로 중복되어 올라가는 것이다.  

내가 한 일은 이랬다.  
1. 내가 새로 브랜치 파서 작업하던 중, main에 새로운 커밋 올라옴  
2. rebase하여 한 줄기로 예쁜 히스토리 만듦  
3. push 하려니까 원격 fetch내용 받아오라고 pull부터 하라고 함. 아 그지 원격이랑 싱크 맞춰야지 -> git pull  
결과: 작성한 커밋이 복사되어 똑같은 내용의 중복 커밋이 생기고 자동생성되는 merge commit까지 생김.  

예를 들면 origin/main에 '1차 데모' - '결제 ui 수정' - '회원 column 수정' - '검색 성능 개선' 이런 커밋이 올라와있다고 하자.  
나는 '1차 데모' 커밋에서 분기한 브랜치를 사용중이다.  
그리고 커밋으로 '회원가입 로직 수정'을 올렸다. 내 로직은 분리된 로직이기에 rebase해도 문제가 없어서 git rebase origin/main을 수행하였다.  

conflict 없이 rebase 되었다면, 내 브랜치 상황은  
'1차 데모' - '결제 ui 수정' - '회원 column 수정' - '검색 성능 개선' - <b>'회원가입 로직 수정'</b> 이 된다.  

이 때 git pull로 pull을 받게 되면?  
pull을 위해 merge를 수행하면서 내 브랜치는 <b>'1차 데모' - '결제 ui 수정' - '회원 column 수정' - '검색 성능 개선' - '회원가입 로직 수정' - '1차 데모 @' - '결제 ui 수정 @' - '회원 column 수정 @' - '검색 성능 개선 @' - '회원가입 로직 수정'</b>  
위와 같은 기형적인 구조가 된다.  
git의 commit hash는 날짜 정보 등을 포함하여 만들어져서 내용이 같다고 해도 값이 다르기 때문에, 다른 커밋으로 인식되어 히스토리에 남게 되는 것이다.  
이대로 원격에 push하게 되면.. 히스토리가 엉망이 된다.  

그렇기 때문에 rebase 후에는 현재 원격(origin)브랜치의 최신 커밋을 모두 가져왔음을 꼭 확인하고 git push -f(또는 더 안전하게 --force-with-lease) 해줘야 한다.  
git push -f 를 주면 내 히스토리를 그대로 원격에 적용하는 것인데, rebase를 하게 되면 내 커밋을 포함하여 히스토리가 달라지는 것이기 때문에 그냥 push를 할 수가 없어 push -f를 해줄 수 밖에 없다.  
<br>